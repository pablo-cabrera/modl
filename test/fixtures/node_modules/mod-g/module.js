(function (node) {
    var parts = node? require("parts"): window.parts;

    modl.$module({
        "/module": function() {
            "use strict";

            modl.
            uses("/lib/Thing").
            uses("/lib/AnotherThing").
            uses("bar").
            uses("baz").

            unit(function(module) {
                module.exports.name = "foo";

                parts.forEach(module.imports, function(v, k) {
                    module.exports[k] = v;
                });
            });
        },
        "/lib/AnotherThing": function() {
            "use strict";

            modl.
            uses("/lib/Thing").
            unit(function(module, Thing) {
                module.exports.name = "foo-AnotherThing";
                module.exports.Thing = Thing;
            });
        },
        "/lib/Thing": function() {
            "use strict";

            modl.
            unit(function(module) {
                module.exports.name = "foo-Thing";
            });
        },
        "bar": {
            "/module": function() {
                "use strict";

                modl.
                uses("/lib/Thing").
                uses("/lib/AnotherThing").
                uses("baz").

                unit(function(module) {

                    module.exports.name = "bar";

                    parts.forEach(module.imports, function(v, k) {
                        module.exports[k] = v;
                    });
                });
            },
            "/lib/AnotherThing": function() {
                "use strict";

                modl.
                uses("/lib/Thing").
                unit(function(module, Thing) {
                    module.exports.name = "bar-AnotherThing";
                    module.exports.Thing = Thing;
                });
            },
            "/lib/Thing": function() {
                "use strict";

                modl.
                unit(function(module) {
                    module.exports.name = "bar-Thing";
                });
            },
            "baz": "baz"
        },
        "baz": {
            "/module": function() {
                "use strict";

                modl.
                uses("/lib/Thing").
                uses("/lib/AnotherThing").

                unit(function(module) {
                    module.exports.name = "baz";

                    parts.forEach(module.imports, function(v, k) {
                        module.exports[k] = v;
                    });
                });
            },
            "/lib/AnotherThing": function() {
                "use strict";

                modl.
                uses("/lib/Thing").
                unit(function(module, Thing) {
                    module.exports.name = "baz-AnotherThing";
                    module.exports.Thing = Thing;
                });
            },
            "/lib/Thing": function() {
                "use strict";

                modl.
                unit(function(module) {
                    module.exports.name = "baz-Thing";
                });
            }
        }
    });
}(typeof exports !== "undefined" && global.exports !== exports));
